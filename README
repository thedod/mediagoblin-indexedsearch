=======================
mediagoblin-indexedsearch
=======================

This is a plugin for Gnu Mediagoblin that adds support for searching media.

By default, the search function will query the tags, title and description fields
of media for the given phrase.

More complex queries are supported, e.g searching for media with tagged with "hello"
and not tagged with "goodbye" (tag:hello -tag:goodbye), or searching for any
media added by the user "tom" (user:tom).

(See http://whoosh.readthedocs.org/en/latest/querylang.html for more syntax info.)

This plugin is based on an existing search plugin, https://github.com/ayleph/mediagoblin-basicsearch/,
but uses a search index for queries.

Testing on python 3.5 and python 2.7.


Set up the search plugin
========================

1. Clone the search plugin repository from GitHub.

    $ git clone https://github.com/tofay/mediagoblin-indexedsearch.git

2. Create a source tarball.

    $ /path/to/mediagoblin/bin/python setup.py sdist

2. Install this into your mediagoblin virtualenv.

    $ /path/to/mediagoblin/bin/pip install dist/mediagoblin-indexedsearch-#VERSION#.tar.gz

3. Enable the mediagoblin-indexedsearch plugin by adding the following line to the ``[plugins]`` section of your mediagoblin_local.ini file.

    [[indexedsearch]]

4. Restart your MediaGoblin instance for the config file changes to be effective.

Configure the search plugin
===========================

The following parameters can be specified in the indexedsearch section of your mediagoblin
config file.

SEARCH_LINK_STYLE = 'link'

Specifies the style of the search link that is added to the top header bar of the MediaGoblin instance.
The options for the search link display style are:

* ``form`` displays a search form next to the Log In link. This is the default display style.
* ``link`` displays a normal text link next to the Log In link.
* ``button`` displays an action button link next to the Log In link.
* ``none`` does not display a link. This is useful if you want to create your own search link in a user_dev template or custom theme.

INDEX_DIR = '/path/to/index/directory'

Specifies the directory in which the plugin will create a search index (the plugin will
create the directory if it doesn't exist, assuming correct permissions etc.). By default the index
will be created in /path/to/mediagoblin/user_dev/searchindex.

USERS_ONLY = True

Specifies whether or not searching for content requires being logged-in. Defaults to True.
